"0",""
"0","list_plots <- vector(mode = ""list"", length = length(test_scores_per_education_level_list))"
"0",""
"0","for (i in seq_along(test_scores_per_education_level_list))  { "
"0",""
"0","  # flexible bin-width"
"0",""
"0","  max_value <- max(test_scores_per_education_level_list[[i]]$test_scores, na.rm = TRUE)"
"0",""
"0","  binwidth <- max_value / 40 "
"0",""
"0","  "
"0",""
"0","  # IQR-range"
"0",""
"0","  IQR_upper_x_coord <- test_scores_per_education_level_list[[i]]$IQR_upper[1]"
"0",""
"0","  IQR_range_label <- paste0('iqr: ', test_scores_per_education_level_list[[i]]$IQR_range[1], '%')"
"0",""
"0","  "
"0",""
"0","  # plot histogram"
"0",""
"0","plot_result <- test_scores_per_education_level_list[[i]] |>"
"0",""
"0",""
"0","  mutate(color = ifelse(test_scores > outlier_threshold_1 | test_scores < outlier_threshold_2, ""darkred"", ""grey"")) |>"
"0",""
"0"," "
"0",""
"0","  ggplot(aes(x = test_scores, fill = color)) +"
"0",""
"0","  facet_grid(cols = vars(education_levels), scales = 'fixed') +"
"0",""
"0","  scale_x_continuous(breaks = scales::pretty_breaks(), labels = scales::percent_format(scale = 1), expand = expansion(mult = c(0, 0.05))) +"
"0",""
"0","  scale_y_continuous(breaks = scales::pretty_breaks(), labels = scales::number_format(accuracy = 1)) +"
"0",""
"0","  geom_histogram(binwidth = binwidth) +"
"0",""
"0","  scale_fill_identity() +"
"0",""
"0","geom_segment(aes(x = median_test_score, xend = median_test_score, y = 0, yend = Inf), color = ""darkgreen"", linewidth = 0.5, linetype = ""dashed"") +"
"0",""
"0","  geom_segment(aes(x = IQR_lower, xend = IQR_lower, y = 0, yend = Inf), color = ""blue"", linewidth = 0.5, linetype = ""dashed"") +"
"0",""
"0","  geom_segment(aes(x = IQR_upper, xend = IQR_upper, y = 0, yend = Inf), color = ""blue"", linewidth = 0.5, linetype = ""dashed"")  +"
"0",""
"0","  labs(x = ""test scores"", y = ""number of students"") +"
"0",""
"0","  theme_bw() +"
"0",""
"0","  theme(axis.title.x = element_text(size = 10),  # Adjust x-axis title size"
"0",""
"0","        axis.title.y = element_text(size = 10))   # Adjust y-axis title size"
"0",""
"0"," "
"0",""
"0","max_count_bin <- max(ggplot_build(plot_result)$data[[1]]$count)"
"0",""
"0","# tekstannotatie toevoegen over iqr-range"
"0",""
"0","plot_result_with_annotation <- plot_result +"
"0",""
"0","  annotate(""text"", x = IQR_upper_x_coord + (0.04 * max_value), y = 0.9 * max_count_bin, label = IQR_range_label, vjust = 1, hjust = 0, color = ""blue"", size = 3)"
"0",""
"0"," "
"0",""
"0","list_plots[[i]] <- plot_result_with_annotation"
"0",""
"0","}"
"0",""
